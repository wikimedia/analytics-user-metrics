{% extends "layout.html" %}
{% block body %}

{% if invalid %}
<h4>In-Valid Users</h4>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Username</th>
            <th>Project</th>
            <th>Reason Invalid</th>
        </tr>
    </thead>
    <tbody data-bind="foreach: invalid">
        <tr>
            <td data-bind="text: username"></td>
            <td data-bind="text: project"></td>
            <td data-bind="text: reason_invalid"></td>
        </tr>
    </tbody>
</table>

<h5>Try uploading again after fixing the issues</h5>
{% include "csv_upload_form.html" %}
<!--form action="/uploads/cohort/validate" method="POST" class="form-horizontal">
    <div class="form-actions">
        <input type="submit" class="btn" value="Re-Check These Users"/>
    </div>
</form-->
{% endif %}

{% if valid %}
<h4>Valid Users</h4>
<table class="table table-striped">
    <thead>
        <tr>
            <th>Username</th>
            <th>Project</th>
        </tr>
    </thead>
    <tbody data-bind="foreach: valid">
        <tr>
            <td data-bind="text: username"></td>
            <td data-bind="text: project"></td>
        </tr>
    </tbody>
</table>
{% endif %}

<form action="/uploads/cohort/finish" method="POST" class="form-horizontal">
    <div class="form-actions">
        <input type="submit" class="btn btn-primary" value="{% if invalid %}Upload Only These Valid Users{% else %}Finish Upload{% endif %}"/>
    </div>
</form>


<script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script>
<script>
    var invalid = JSON.parse('{{ invalid | safe }}');
    var valid = JSON.parse('{{ valid | safe }}');
    $(document).ready(function(){
        ko.applyBindings({
            invalid: ko.observableArray(invalid),
            valid: ko.observableArray(valid)
        });
    });
</script>
{% endblock %}
